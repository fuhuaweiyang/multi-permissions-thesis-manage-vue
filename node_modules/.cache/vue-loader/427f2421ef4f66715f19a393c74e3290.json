{"remainingRequest":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\src\\views\\scoremanagement\\Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\src\\views\\scoremanagement\\Detail.vue","mtime":1743880105171},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1711182482575},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1711182506214}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFydGljbGVDb250ZW50OiBg6L+Z6YeM5piv5LiA56+H56S65L6L5paH56ug5YaF5a6577yM5YyF5ZCr5aSa5Liq5q616JC944CC5pWZ5biI5Y+v5Lul6YCJ5Lit5Lu75oSP5paH5pys54mH5q616L+b6KGM5om55rOo44CCCiAgICAgICAg5om55rOo5Yqf6IO96ZyA6KaB5YeG56Gu6K6w5b2V6YCJ5Lit5paH5pys55qE5L2N572u5ZKM5YaF5a6577yM5bm25pSv5oyB5ZCO57ut55qE5bGV56S65ZKM6L+Y5Y6f44CCYCwKICAgICAgYW5ub3RhdGlvbnM6IFtdLAogICAgICBzZWxlY3RlZFRleHQ6ICcnLAogICAgICBzZWxlY3RlZFJhbmdlOiBudWxsLAogICAgICBzaG93Q29tbWVudElucHV0OiBmYWxzZSwKICAgICAgY29tbWVudElucHV0OiAnJwogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLy8g55Sf5oiQ5YyF5ZCr5om55rOo5qCH6K6w55qE5YaF5a65CiAgICBhbm5vdGF0ZWRDb250ZW50KCkgewogICAgICBsZXQgY29udGVudCA9IHRoaXMuYXJ0aWNsZUNvbnRlbnQ7CiAgICAgIHRoaXMuYW5ub3RhdGlvbnMuZm9yRWFjaChhbm5vID0+IHsKICAgICAgICBjb25zdCBoaWdobGlnaHQgPSBgPHNwYW4gY2xhc3M9ImhpZ2hsaWdodCIgZGF0YS1pZD0iJHthbm5vLmlkfSI+JHthbm5vLnNlbGVjdGVkVGV4dH08L3NwYW4+YDsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKGFubm8uc2VsZWN0ZWRUZXh0LCBoaWdobGlnaHQpOwogICAgICB9KTsKICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICB9LAoKICAgIC8vIOW6j+WIl+WMluaJueazqOS/oeaBrwogICAgc2VyaWFsaXplZEFubm90YXRpb25zKCkgewogICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5hbm5vdGF0aW9ucyk7CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgaGFuZGxlVGV4dFNlbGVjdGlvbigpIHsKICAgICAgY29uc3Qgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOwogICAgICBpZiAoIXNlbGVjdGlvbi5yYW5nZUNvdW50KSByZXR1cm47CgogICAgICBjb25zdCByYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KDApOwogICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSByYW5nZS50b1N0cmluZygpLnRyaW0oKTsKCiAgICAgIGlmIChzZWxlY3RlZFRleHQpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkVGV4dCA9IHNlbGVjdGVkVGV4dDsKICAgICAgICB0aGlzLnNlbGVjdGVkUmFuZ2UgPSByYW5nZTsKICAgICAgICB0aGlzLnNob3dDb21tZW50SW5wdXQgPSB0cnVlOwogICAgICB9CiAgICB9LAoKICAgIHNhdmVBbm5vdGF0aW9uKCkgewogICAgICBpZiAoIXRoaXMuY29tbWVudElucHV0KSByZXR1cm47CgogICAgICBjb25zdCBuZXdBbm5vdGF0aW9uID0gewogICAgICAgIGlkOiBEYXRlLm5vdygpLAogICAgICAgIHNlbGVjdGVkVGV4dDogdGhpcy5zZWxlY3RlZFRleHQsCiAgICAgICAgY29tbWVudDogdGhpcy5jb21tZW50SW5wdXQsCiAgICAgICAgc3RhcnRPZmZzZXQ6IHRoaXMuc2VsZWN0ZWRSYW5nZS5zdGFydE9mZnNldCwKICAgICAgICBlbmRPZmZzZXQ6IHRoaXMuc2VsZWN0ZWRSYW5nZS5lbmRPZmZzZXQsCiAgICAgICAgc3RhcnRDb250YWluZXJQYXRoOiB0aGlzLmdldE5vZGVQYXRoKHRoaXMuc2VsZWN0ZWRSYW5nZS5zdGFydENvbnRhaW5lciksCiAgICAgICAgZW5kQ29udGFpbmVyUGF0aDogdGhpcy5nZXROb2RlUGF0aCh0aGlzLnNlbGVjdGVkUmFuZ2UuZW5kQ29udGFpbmVyKQogICAgICB9OwoKICAgICAgdGhpcy5hbm5vdGF0aW9ucy5wdXNoKG5ld0Fubm90YXRpb24pOwogICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7CiAgICB9LAoKICAgIGNhbmNlbEFubm90YXRpb24oKSB7CiAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTsKICAgIH0sCgogICAgY2xlYXJTZWxlY3Rpb24oKSB7CiAgICAgIHRoaXMuc2hvd0NvbW1lbnRJbnB1dCA9IGZhbHNlOwogICAgICB0aGlzLmNvbW1lbnRJbnB1dCA9ICcnOwogICAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7CiAgICB9LAoKICAgIC8vIOWwhkRPTeiKgueCuei3r+W+hOi9rOaNouS4uuWPr+W6j+WIl+WMlueahOi3r+W+hAogICAgZ2V0Tm9kZVBhdGgobm9kZSkgewogICAgICBjb25zdCBwYXRoID0gW107CiAgICAgIHdoaWxlIChub2RlLnBhcmVudE5vZGUpIHsKICAgICAgICBwYXRoLnB1c2goQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChub2RlLnBhcmVudE5vZGUuY2hpbGROb2Rlcywgbm9kZSkpOwogICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7CiAgICAgIH0KICAgICAgcmV0dXJuIHBhdGg7CiAgICB9LAoKICAgIC8vIOS7juW6j+WIl+WMluWtl+espuS4suWKoOi9veaJueazqAogICAgbG9hZEFubm90YXRpb25zKHNlcmlhbGl6ZWQpIHsKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLmFubm90YXRpb25zID0gSlNPTi5wYXJzZShzZXJpYWxpemVkKS5tYXAoYW5ubyA9PiAoewogICAgICAgICAgLi4uYW5ubywKICAgICAgICAgIHJhbmdlOiB0aGlzLnJlc3RvcmVSYW5nZShhbm5vKQogICAgICAgIH0pKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+ino+aekOaJueazqOWksei0pTonLCBlKTsKICAgICAgfQogICAgfSwKCiAgICAvLyDov5jljp9SYW5nZeWvueixoQogICAgcmVzdG9yZVJhbmdlKGFubm90YXRpb24pIHsKICAgICAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICAKICAgICAgbGV0IHN0YXJ0Tm9kZSA9IGRvY3VtZW50LmJvZHk7CiAgICAgIGFubm90YXRpb24uc3RhcnRDb250YWluZXJQYXRoLnJldmVyc2UoKS5mb3JFYWNoKGluZGV4ID0+IHsKICAgICAgICBzdGFydE5vZGUgPSBzdGFydE5vZGUuY2hpbGROb2Rlc1tpbmRleF07CiAgICAgIH0pOwoKICAgICAgbGV0IGVuZE5vZGUgPSBkb2N1bWVudC5ib2R5OwogICAgICBhbm5vdGF0aW9uLmVuZENvbnRhaW5lclBhdGgucmV2ZXJzZSgpLmZvckVhY2goaW5kZXggPT4gewogICAgICAgIGVuZE5vZGUgPSBlbmROb2RlLmNoaWxkTm9kZXNbaW5kZXhdOwogICAgICB9KTsKCiAgICAgIHJhbmdlLnNldFN0YXJ0KHN0YXJ0Tm9kZSwgYW5ub3RhdGlvbi5zdGFydE9mZnNldCk7CiAgICAgIHJhbmdlLnNldEVuZChlbmROb2RlLCBhbm5vdGF0aW9uLmVuZE9mZnNldCk7CiAgICAgIHJldHVybiByYW5nZTsKICAgIH0sCgogICAgc2Nyb2xsVG9Bbm5vdGF0aW9uKGFubm90YXRpb24pIHsKICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWlkPSIke2Fubm90YXRpb24uaWR9Il1gKTsKICAgICAgaWYgKGVsZW1lbnQpIHsKICAgICAgICBlbGVtZW50LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0pOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/scoremanagement","sourcesContent":["<template>\r\n    <div class=\"container\">\r\n      <!-- 文章内容区域 -->\r\n      <div \r\n        class=\"article-content\"\r\n        @mouseup=\"handleTextSelection\"\r\n        v-html=\"annotatedContent\"\r\n      ></div>\r\n  \r\n      <!-- 批注输入弹窗 -->\r\n      <div v-if=\"showCommentInput\" class=\"annotation-modal\">\r\n        <div class=\"selected-text\">选中的文本：{{ selectedText }}</div>\r\n        <textarea v-model=\"commentInput\" placeholder=\"请输入批注内容\"></textarea>\r\n        <button @click=\"saveAnnotation\">保存批注</button>\r\n        <button @click=\"cancelAnnotation\">取消</button>\r\n      </div>\r\n  \r\n      <!-- 批注展示 -->\r\n      <div class=\"annotations-list\">\r\n        <div v-for=\"(annotation, index) in annotations\" :key=\"index\" class=\"annotation-item\">\r\n          <span class=\"highlight\" @click=\"scrollToAnnotation(annotation)\">\r\n            {{ annotation.selectedText }}\r\n          </span>\r\n          <div class=\"comment\">{{ annotation.comment }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import axios from 'axios';\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        articleContent: `这里是一篇示例文章内容，包含多个段落。教师可以选中任意文本片段进行批注。\r\n          批注功能需要准确记录选中文本的位置和内容，并支持后续的展示和还原。`,\r\n        annotations: [],\r\n        selectedText: '',\r\n        selectedRange: null,\r\n        showCommentInput: false,\r\n        commentInput: ''\r\n      };\r\n    },\r\n  \r\n    computed: {\r\n      // 生成包含批注标记的内容\r\n      annotatedContent() {\r\n        let content = this.articleContent;\r\n        this.annotations.forEach(anno => {\r\n          const highlight = `<span class=\"highlight\" data-id=\"${anno.id}\">${anno.selectedText}</span>`;\r\n          content = content.replace(anno.selectedText, highlight);\r\n        });\r\n        return content;\r\n      },\r\n  \r\n      // 序列化批注信息\r\n      serializedAnnotations() {\r\n        return JSON.stringify(this.annotations);\r\n      }\r\n    },\r\n  \r\n    methods: {\r\n      handleTextSelection() {\r\n        const selection = window.getSelection();\r\n        if (!selection.rangeCount) return;\r\n  \r\n        const range = selection.getRangeAt(0);\r\n        const selectedText = range.toString().trim();\r\n  \r\n        if (selectedText) {\r\n          this.selectedText = selectedText;\r\n          this.selectedRange = range;\r\n          this.showCommentInput = true;\r\n        }\r\n      },\r\n  \r\n      saveAnnotation() {\r\n        if (!this.commentInput) return;\r\n  \r\n        const newAnnotation = {\r\n          id: Date.now(),\r\n          selectedText: this.selectedText,\r\n          comment: this.commentInput,\r\n          startOffset: this.selectedRange.startOffset,\r\n          endOffset: this.selectedRange.endOffset,\r\n          startContainerPath: this.getNodePath(this.selectedRange.startContainer),\r\n          endContainerPath: this.getNodePath(this.selectedRange.endContainer)\r\n        };\r\n  \r\n        this.annotations.push(newAnnotation);\r\n        this.clearSelection();\r\n      },\r\n  \r\n      cancelAnnotation() {\r\n        this.clearSelection();\r\n      },\r\n  \r\n      clearSelection() {\r\n        this.showCommentInput = false;\r\n        this.commentInput = '';\r\n        window.getSelection().removeAllRanges();\r\n      },\r\n  \r\n      // 将DOM节点路径转换为可序列化的路径\r\n      getNodePath(node) {\r\n        const path = [];\r\n        while (node.parentNode) {\r\n          path.push(Array.prototype.indexOf.call(node.parentNode.childNodes, node));\r\n          node = node.parentNode;\r\n        }\r\n        return path;\r\n      },\r\n  \r\n      // 从序列化字符串加载批注\r\n      loadAnnotations(serialized) {\r\n        try {\r\n          this.annotations = JSON.parse(serialized).map(anno => ({\r\n            ...anno,\r\n            range: this.restoreRange(anno)\r\n          }));\r\n        } catch (e) {\r\n          console.error('解析批注失败:', e);\r\n        }\r\n      },\r\n  \r\n      // 还原Range对象\r\n      restoreRange(annotation) {\r\n        const range = document.createRange();\r\n        \r\n        let startNode = document.body;\r\n        annotation.startContainerPath.reverse().forEach(index => {\r\n          startNode = startNode.childNodes[index];\r\n        });\r\n  \r\n        let endNode = document.body;\r\n        annotation.endContainerPath.reverse().forEach(index => {\r\n          endNode = endNode.childNodes[index];\r\n        });\r\n  \r\n        range.setStart(startNode, annotation.startOffset);\r\n        range.setEnd(endNode, annotation.endOffset);\r\n        return range;\r\n      },\r\n  \r\n      scrollToAnnotation(annotation) {\r\n        const element = document.querySelector(`[data-id=\"${annotation.id}\"]`);\r\n        if (element) {\r\n          element.scrollIntoView({ behavior: 'smooth' });\r\n        }\r\n      }\r\n    }\r\n  };\r\n  </script>\r\n  \r\n  <style>\r\n  .container {\r\n    display: flex;\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n  }\r\n  \r\n  .article-content {\r\n    flex: 2;\r\n    padding: 20px;\r\n    line-height: 1.6;\r\n    border-right: 1px solid #ccc;\r\n  }\r\n  \r\n  .annotations-list {\r\n    flex: 1;\r\n    padding: 20px;\r\n  }\r\n  \r\n  .highlight {\r\n    background-color: #ffeb3b;\r\n    cursor: pointer;\r\n  }\r\n  \r\n  .annotation-modal {\r\n    position: fixed;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    background: white;\r\n    padding: 20px;\r\n    border: 1px solid #ccc;\r\n    box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n    z-index: 1000;\r\n  }\r\n  \r\n  .annotation-item {\r\n    margin-bottom: 15px;\r\n    padding: 10px;\r\n    border: 1px solid #eee;\r\n  }\r\n  </style>"]}]}