{"remainingRequest":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\src\\views\\student\\MarkDownNotHomeWork.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\src\\views\\student\\MarkDownNotHomeWork.vue","mtime":1742906568574},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1711182482575},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"C:\\Users\\18133\\Desktop\\在线学习系统\\源码\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1711182506214}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCiAgaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IGpzQ29va2llIGZyb20gJ2pzLWNvb2tpZSc7CiAgCiAgZXhwb3J0IGRlZmF1bHQgewogICAgZGF0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBob21ld29ya0RhdGE6IHsKICAgICAgICAgIHRpdGxlOiAnJywKICAgICAgICAgIGNvbnRlbnQ6ICcnCiAgICAgICAgfSwKICAgICAgICBmaWxlTGlzdDogW10KICAgICAgfTsKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgIGdvT3RoZXJzKCkgewogICAgICAgIC8vIOS9oOeahOi/lOWbnumAu+i+kQogICAgICB9LAogICAgICAKICAgICAgaGFuZGxlRmlsZUNoYW5nZShmaWxlLCBmaWxlTGlzdCkgewogICAgICAgIC8vIOmqjOivgeaWh+S7tuagvOW8j+WSjOWkp+WwjwogICAgICAgIGNvbnN0IHZhbGlkVHlwZXMgPSBbJ2FwcGxpY2F0aW9uL21zd29yZCcsICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCddOwogICAgICAgIGNvbnN0IGlzRG9jID0gdmFsaWRUeXBlcy5pbmNsdWRlcyhmaWxlLnJhdy50eXBlKSB8fCAKICAgICAgICAgICAgICAgICAgICAgZmlsZS5yYXcubmFtZS5lbmRzV2l0aCgnLmRvYycpIHx8IAogICAgICAgICAgICAgICAgICAgICBmaWxlLnJhdy5uYW1lLmVuZHNXaXRoKCcuZG9jeCcpOwogICAgICAgIGNvbnN0IGlzTHQ1MDBLQiA9IGZpbGUucmF3LnNpemUgLyAxMDI0IDwgNTAwOwogIAogICAgICAgIGlmICghaXNEb2MpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WPquiDveS4iuS8oGRvYy9kb2N45qC85byP5paH5Lu2Jyk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGlmICghaXNMdDUwMEtCKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmlofku7blpKflsI/kuI3og73otoXov4c1MDBLQicpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAKICAgICAgICB0aGlzLmZpbGVMaXN0ID0gZmlsZUxpc3Q7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9LAogIAogICAgICBoYW5kbGVGaWxlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgICAgdGhpcy5maWxlTGlzdCA9IGZpbGVMaXN0OwogICAgICB9LAogIAogICAgICBhc3luYyBzdWJtaXQoKSB7CiAgICAgICAgLy8g6aqM6K+B6KGo5Y2V5pWw5o2uCiAgICAgICAgaWYgKCF0aGlzLmhvbWV3b3JrRGF0YS50aXRsZS50cmltKCkpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+i+k+WFpeagh+mimCcpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoIXRoaXMuaG9tZXdvcmtEYXRhLmNvbnRlbnQudHJpbSgpKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7fovpPlhaXlhoXlrrknKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuZmlsZUxpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7fpgInmi6nopoHkuIrkvKDnmoTmlofku7YnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgCiAgICAgICAgLy8g5p6E6YCg6KGo5Y2V5pWw5o2uCiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RpdGxlJywgdGhpcy5ob21ld29ya0RhdGEudGl0bGUpOwogICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnY29udGVudCcsIHRoaXMuaG9tZXdvcmtEYXRhLmNvbnRlbnQpOwogICAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcklkJywganNDb29raWUuZ2V0KCd1c2VySWQnKSk7CiAgICAgICAgdGhpcy5maWxlTGlzdC5mb3JFYWNoKGZpbGUgPT4gewogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlcycsIGZpbGUucmF3KTsKICAgICAgICB9KTsKCgogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6OTI1MS9hcGkvZG9jcy91cGxvYWQnLCBmb3JtRGF0YSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIAogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmj5DkuqTmiJDlip8nKTsKICAgICAgICAgIC8vIOa4heepuuihqOWNlQogICAgICAgICAgdGhpcy5ob21ld29ya0RhdGEgPSB7IHRpdGxlOiAnJywgY29udGVudDogJycgfTsKICAgICAgICAgIHRoaXMuZmlsZUxpc3QgPSBbXTsKICAgICAgICAgIHRoaXMuJHJlZnMudXBsb2FkUmVmLmNsZWFyRmlsZXMoKTsKICAgICAgICAgIAogICAgICAgICAgLy8g6L+Z6YeM5Y+v5Lul5re75Yqg5o+Q5Lqk5oiQ5Yqf5ZCO55qE5YW25LuW6YC76L6RCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aPkOS6pOWksei0pScpOwogICAgICAgICAgY29uc29sZS5lcnJvcign5LiK5Lyg6ZSZ6K+vOicsIGVycm9yKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwogIA=="},{"version":3,"sources":["MarkDownNotHomeWork.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MarkDownNotHomeWork.vue","sourceRoot":"src/views/student","sourcesContent":["<template>\r\n    <div style=\"padding: 20px;\">\r\n      <el-button type=\"danger\" @click=\"goOthers()\">返回</el-button>\r\n      <el-button type=\"success\" @click=\"submit\">提交</el-button>\r\n  \r\n      <el-input \r\n        v-model=\"homeworkData.title\" \r\n        placeholder=\"请输入标题\" \r\n        style=\"margin-bottom: 10px;\"\r\n      ></el-input>\r\n      <el-input\r\n        v-model=\"homeworkData.content\"\r\n        placeholder=\"请输入内容\"\r\n        type=\"textarea\"\r\n        style=\"margin-bottom: 10px;\"\r\n      ></el-input>\r\n  \r\n      <el-upload\r\n        class=\"upload-demo\"\r\n        drag\r\n        :auto-upload=\"false\"\r\n        :multiple=\"true\"\r\n        :on-change=\"handleFileChange\"\r\n        :before-remove=\"handleFileRemove\"\r\n        ref=\"uploadRef\"\r\n      >\r\n        <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n        <div class=\"el-upload__text\">\r\n          将文件拖到此处或<em>点击上传</em>\r\n        </div>\r\n        <template #tip>\r\n          <div class=\"el-upload__tip\">\r\n            仅支持500kb以下的doc/docx文件\r\n          </div>\r\n        </template>\r\n      </el-upload>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import axios from 'axios';\r\nimport jsCookie from 'js-cookie';\r\n  \r\n  export default {\r\n    data() {\r\n      return {\r\n        homeworkData: {\r\n          title: '',\r\n          content: ''\r\n        },\r\n        fileList: []\r\n      };\r\n    },\r\n    methods: {\r\n      goOthers() {\r\n        // 你的返回逻辑\r\n      },\r\n      \r\n      handleFileChange(file, fileList) {\r\n        // 验证文件格式和大小\r\n        const validTypes = ['application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\r\n        const isDoc = validTypes.includes(file.raw.type) || \r\n                     file.raw.name.endsWith('.doc') || \r\n                     file.raw.name.endsWith('.docx');\r\n        const isLt500KB = file.raw.size / 1024 < 500;\r\n  \r\n        if (!isDoc) {\r\n          this.$message.error('只能上传doc/docx格式文件');\r\n          return false;\r\n        }\r\n        if (!isLt500KB) {\r\n          this.$message.error('文件大小不能超过500KB');\r\n          return false;\r\n        }\r\n  \r\n        this.fileList = fileList;\r\n        return false;\r\n      },\r\n  \r\n      handleFileRemove(file, fileList) {\r\n        this.fileList = fileList;\r\n      },\r\n  \r\n      async submit() {\r\n        // 验证表单数据\r\n        if (!this.homeworkData.title.trim()) {\r\n          this.$message.error('请输入标题');\r\n          return;\r\n        }\r\n        if (!this.homeworkData.content.trim()) {\r\n          this.$message.error('请输入内容');\r\n          return;\r\n        }\r\n        if (this.fileList.length === 0) {\r\n          this.$message.error('请选择要上传的文件');\r\n          return;\r\n        }\r\n  \r\n        // 构造表单数据\r\n        const formData = new FormData();\r\n        formData.append('title', this.homeworkData.title);\r\n        formData.append('content', this.homeworkData.content);\r\n        formData.append('userId', jsCookie.get('userId'));\r\n        this.fileList.forEach(file => {\r\n          formData.append('files', file.raw);\r\n        });\r\n\r\n\r\n        try {\r\n          const response = await axios.post('http://localhost:9251/api/docs/upload', formData, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data'\r\n            }\r\n          });\r\n          \r\n          this.$message.success('提交成功');\r\n          // 清空表单\r\n          this.homeworkData = { title: '', content: '' };\r\n          this.fileList = [];\r\n          this.$refs.uploadRef.clearFiles();\r\n          \r\n          // 这里可以添加提交成功后的其他逻辑\r\n        } catch (error) {\r\n          this.$message.error('提交失败');\r\n          console.error('上传错误:', error);\r\n        }\r\n      }\r\n    }\r\n  };\r\n  </script>"]}]}